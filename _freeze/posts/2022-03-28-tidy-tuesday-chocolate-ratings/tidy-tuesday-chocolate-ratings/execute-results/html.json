{
  "hash": "ea7bfb587ed317c994c7d2e1ce09fcff",
  "result": {
    "markdown": "---\ntitle: \"Tidy Tuesday:  Chocolate Ratings\"\ndescription: \"Visualizing and extracting information from chocolate ratings reviewed by The Manhattan Chocolate Society\"\nauthor: \n  - name: Bhabishya Neupane\ndate: \"2022-03-27\"\ncategories: [Tidy Tuesday, ggplot2]\n---\n\n\n\n\n### Libraries\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(nationalparkcolors)\nlibrary(paletteer)\nlibrary(tidytuesdayR)\nlibrary(extrafontdb)\nlibrary(showtextdb)\nlibrary(extrafont)\nlibrary(showtext)\nlibrary(ggtext)\nlibrary(glue)\nlibrary(ggridges)\nshowtext_auto()\ntheme_set(theme_minimal())\nfont_add_google(\"BenchNine\", family = \"BenchNine\")\n```\n:::\n\n### Data\n\n::: {.cell}\n\n```{.r .cell-code}\nchocolate <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-18/chocolate.csv') %>% \n  mutate(first_memorable_characteristics = str_remove(most_memorable_characteristics, pattern = \",.*\"))\n```\n:::\n\n### Exploratory Data Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchocolate %>% \n  count(company_location, sort = TRUE) %>% \n  reactable::reactable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-13d9ce22c9135b76283e\" class=\"reactable html-widget\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-13d9ce22c9135b76283e\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"company_location\":[\"U.S.A.\",\"Canada\",\"France\",\"U.K.\",\"Italy\",\"Belgium\",\"Ecuador\",\"Australia\",\"Switzerland\",\"Germany\",\"Spain\",\"Denmark\",\"Japan\",\"Venezuela\",\"Austria\",\"Colombia\",\"New Zealand\",\"Hungary\",\"Brazil\",\"Peru\",\"Madagascar\",\"Vietnam\",\"Singapore\",\"Amsterdam\",\"Dominican Republic\",\"Scotland\",\"South Korea\",\"Guatemala\",\"Mexico\",\"Nicaragua\",\"Taiwan\",\"Argentina\",\"Costa Rica\",\"Israel\",\"Lithuania\",\"Netherlands\",\"Poland\",\"Honduras\",\"Sweden\",\"Ireland\",\"Philippines\",\"Thailand\",\"U.A.E.\",\"Fiji\",\"Iceland\",\"Puerto Rico\",\"Sao Tome\",\"Sao Tome & Principe\",\"South Africa\",\"Vanuatu\",\"Czech Republic\",\"El Salvador\",\"Grenada\",\"Malaysia\",\"Norway\",\"Portugal\",\"Russia\",\"St. Lucia\",\"Bolivia\",\"Chile\",\"Finland\",\"India\",\"Ghana\",\"Martinique\",\"St.Vincent-Grenadines\",\"Suriname\",\"Wales\"],\"n\":[1136,177,176,133,78,63,58,53,44,42,36,31,31,31,30,29,27,26,25,23,17,16,15,12,11,11,11,10,10,10,10,9,9,9,8,8,8,6,6,5,5,5,5,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,2,2,2,2,1,1,1,1,1]},\"columns\":[{\"accessor\":\"company_location\",\"name\":\"company_location\",\"type\":\"character\"},{\"accessor\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"defaultPageSize\":10,\"paginationType\":\"numbers\",\"showPageInfo\":true,\"minRows\":1,\"dataKey\":\"89674d3dbe67a7229a3b0cdf6e65bd4c\",\"key\":\"89674d3dbe67a7229a3b0cdf6e65bd4c\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n\n```{.r .cell-code}\n# Commonly used ingredients in chocolate manufacturing companies across the world\nchocolate %>% \n  filter(!is.na(ingredients)) %>% \n  add_count(ingredients) %>% \n  filter(n>= 100) %>% \n  count(ingredients, sort = TRUE) %>% \n  mutate(ingredients = ingredients %>% fct_reorder(n)) %>% \n  ggplot(aes(n, ingredients))+\n  geom_col(fill = \"#769370\", alpha = 0.8)+\n  labs(x = \"\", y = \"Ingredients\", \n       subtitle = \"<span style = 'color:#454B68'>B stands for Beans, S stands for Sugar, C stands for Cocoa Butter, L stands for Lecithin, and V stands for Vanilla</span>\",\n       title = \"Commonly Used Ingredients by the Chocolate Manufacturing Companies\", \n       caption = \"Data Source: The Manhattan Chocolate Society\")+\n  theme(text = element_text(family = \"BenchNine\"), \n        plot.title = element_text(size = 17, face = \"bold\"), \n        plot.subtitle = element_markdown())\n```\n\n::: {.cell-output-display}\n![](tidy-tuesday-chocolate-ratings_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntop_8_most_reviewed_countries <- chocolate %>% \n  count(company_location, sort = T) %>% \n  filter(n >= 50) %>% \n  pull(company_location)\n\nchocolate %>% \n  mutate(cocoa_percent = parse_number(cocoa_percent)) %>% \n  add_count(company_location) %>%\n  mutate(company_location_and_reviews = glue(\"{company_location} ({n})\")) %>% \n  group_by(review_date, company_location_and_reviews, company_location) %>% \n  summarize(categories = n(),\n            avg_rating     = mean(rating),\n            max_rated_manufacturer = first(company_manufacturer[which.max(rating)]),\n            min_rated_manufacturer = first(company_manufacturer[which.min(rating)]),\n            max_rated_manufacturer_rating = first(rating[which.max(rating)]),\n            min_rated_manufacturer_rating = first(rating[which.min(rating)])) %>% \n  ungroup() %>% \n  add_count(company_location) %>% \n  mutate(company_location_and_reviews = company_location_and_reviews %>% fct_reorder(-n)) %>% \n  filter(company_location %in% top_8_most_reviewed_countries) %>% \n  pivot_longer(cols = c(avg_rating, max_rated_manufacturer_rating, min_rated_manufacturer_rating), names_to = \"metrics\") %>% \n  ggplot(aes(review_date, value, color = metrics))+\n  geom_line(size = 0.8)+\n  facet_wrap(~company_location_and_reviews)+\n  theme(text = element_text(family = \"BenchNine\"),\n        plot.title = element_text(size = 15))+\n  labs(x = \"\", \n       y = \"Ratings\",\n       title = \"Top 8 Frequently Reviewed Chocolate Manufacturing Countries w/ Ratings\",\n       subtitle = \"Number inside the parenthesis denotes the number of reviews conducted in said country, 2006-2021\",\n       color = \"Metrics\", \n       caption = \"Data Source: The Manhattan Chocolate Society\")+\n  scale_color_paletteer_d(\"nationalparkcolors::SmokyMountains\")+\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](tidy-tuesday-chocolate-ratings_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n### Where does most reviews come from?\n\n::: {.cell}\n\n```{.r .cell-code}\nchocolate %>% \n  add_count(company_location) %>% \n  arrange(desc(n)) %>% \n  filter(n >= 50) %>% \n  count(company_location, sort = T) %>% \n  mutate(company_location = company_location %>% fct_reorder(n)) %>% \n  ggplot(aes(n, company_location))+\n  geom_col(fill = \"#769370\")+\n  labs(x = \"\", \n       y = \"\")+\n  scale_x_continuous(limits = c(0, 1200), breaks = seq(0, 1200, by = 200))+\n  labs(title = \"Top 8 Frequently Reviewed Chocolate Manufacturing Countries\",\n       subtitle = \"The review was conducted by The Manhattan Chocolate Society\",\n       caption   = \"Data Source: The Manhattan Chocolate Society\")+\n  theme(text = element_text(family = \"BenchNine\"),\n        legend.position = \"none\",\n        plot.title = element_text(size = 20))\n```\n\n::: {.cell-output-display}\n![](tidy-tuesday-chocolate-ratings_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n### Commonly Used Ingredients in Chocolate Manufacturing Companies Across the World\n::: {.cell}\n\n```{.r .cell-code}\nchocolate %>%\n  mutate(company_location = company_location %>% fct_lump(10)) %>%\n  filter(!is.na(ingredients)) %>%\n  add_count(ingredients) %>%\n  filter(n > 200) %>%  # keeping ingredients that occur more than 100 times in the dataset\n  select(-n) %>%\n  group_by(company_location) %>%\n  add_count(ingredients) %>%\n  ungroup() %>%\n  mutate(\n    company_location = company_location %>% fct_relevel(\n      c(\n        \"U.S.A.\",\n        \"Other\",\n        \"Canada\",\n        \"France\",\n        \"U.K.\",\n        \"Italy\",\n        \"Belgium\",\n        \"Ecuador\",\n        \"Australia\",\n        \"Switzerland\",\n        \"Germany\"\n      )\n    ),\n    company_location = company_location %>% fct_reorder(n, .fun = sum)\n  ) %>%\n  ggplot(aes(n, company_location, fill = ingredients)) +\n  geom_col(position = \"dodge\", width = 0.5) +\n  theme(\n    text = element_text(family = \"BenchNine\"),\n    legend.position = \"top\",\n    plot.title = element_text(size = 15, face = \"bold\")\n  ) +\n  scale_fill_paletteer_d(\"nationalparkcolors::SmokyMountains\") +\n  labs(y = \"\",\n       x = \"Frequency\",\n       fill = \"Ingredients\",\n       title = \"Frequently Used Ingredients in Chocolate Manufacturing Companies around the World\",\n       subtitle = \"B stands for Beans, S stands for Sugar, C stands for Cocoa Butter, and L stands for Lecithin\", \n       caption = \"Data Source: The Manhattan Chocolate Society\")\n```\n\n::: {.cell-output-display}\n![](tidy-tuesday-chocolate-ratings_files/figure-html/unnamed-chunk-14-1.png){width=672 height=150%}\n:::\n:::\n\n\n### Ten most frequently reviewed companies in the United States \n\n::: {.cell}\n\n```{.r .cell-code}\nchocolate %>% \n  filter(company_location == \"U.S.A.\") %>% \n  add_count(company_manufacturer) %>% \n  filter(n >= 15) %>% \n  count(company_manufacturer, sort = T) %>% \n  mutate(company_manufacturer = company_manufacturer %>% fct_reorder(n)) %>% \n  slice(1:10) %>% \n  ggplot(aes(n, company_manufacturer))+\n  geom_col(fill = \"#769370\")+\n  labs(x = \"\", \n       y = \"\", \n       title = \"Top 10 Frequently Reviewed Chocolate Manufacturing Companies in the United States\", \n       caption = \"Data Source: The Manhattan Chocolate Society\")+\n  theme(text = element_text(family = \"BenchNine\"),\n        plot.title = element_text(size = 12.5))\n```\n\n::: {.cell-output-display}\n![](tidy-tuesday-chocolate-ratings_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n### Cocoa Percent Distribution\n\n#### In the United States\n\n::: {.cell}\n\n```{.r .cell-code}\nchocolate %>% \n  filter(company_location == \"U.S.A.\") %>% \n  mutate(cocoa_percent = parse_number(cocoa_percent)) %>% \n  ggplot(aes(cocoa_percent))+\n  geom_histogram(color = \"white\", fill = \"#769370\")+\n  expand_limits(x = 50)+\n  labs(y = \"# of Chocolate Manufacturing Companies\", \n       x = \"Cocoa Percent\",\n       title = \"Cocoa Percent Distribution Histogram | U.S.A.\",\n       caption = \"Data Source: The Manhattan Chocolate Society\")+\n  theme(text = element_text(family = \"BenchNine\"),\n        plot.title = element_text(size = 20))+\n  scale_x_continuous(labels = scales::percent_format(scale = 1/1))\n```\n\n::: {.cell-output-display}\n![](tidy-tuesday-chocolate-ratings_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\nFrom the above plot, it does look like most of the companies reviewed by The Manhattan Chocolate Society had cocoa in their products between 70% to 75%. \n\n#### Across the World\n\n::: {.cell}\n\n```{.r .cell-code}\nchocolate %>% \n  mutate(cocoa_percent = parse_number(cocoa_percent)) %>% \n  ggplot(aes(cocoa_percent))+\n  geom_histogram(color = \"white\", fill = \"#769370\")+\n  expand_limits(x = 40)+\n  labs(y = \"# of Chocolate Manufacturing Companies\", \n       x = \"Cocoa Percent\",\n       title = \"Cocoa Percent Distribution Histogram | Globally\", \n       caption = \"Data Source: The Manhattan Chocolate Society\")+\n  theme(text = element_text(family = \"BenchNine\"),\n        plot.title = element_text(size = 20))+\n  scale_x_continuous(labels = scales::percent_format(scale = 1/1))\n```\n\n::: {.cell-output-display}\n![](tidy-tuesday-chocolate-ratings_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n### Word Used to Describe the Chocolate in the USA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchocolate %>%\n  filter(company_location == \"U.S.A.\") %>%\n  add_count(first_memorable_characteristics) %>%\n  filter(n > 28) %>%\n  mutate(first_memorable_characteristics = glue(\"{first_memorable_characteristics} ({n})\"), \n         first_memorable_characteristics = first_memorable_characteristics %>% fct_reorder(n)) %>% \n  ggplot(\n    aes(rating, first_memorable_characteristics, fill = first_memorable_characteristics)\n  ) +\n  geom_density_ridges(alpha = 0.9) +\n  theme(legend.position = \"none\") +\n  scale_fill_paletteer_d(\"nationalparkcolors::GeneralGrant\")+\n  theme(text = element_text(family = \"BenchNine\"), \n        plot.title = element_text(size = 17, face = \"bold\"))+\n  labs(y = \"First Memorable Characteristic of the Chocolate\", \n       x = \"Rating\", \n       title = \"Distribution of Chocolate's First Memorable Characteristics in the USA\", \n       caption = \"Data Source: The Manhattan Chocolate Society\")\n```\n\n::: {.cell-output-display}\n![](tidy-tuesday-chocolate-ratings_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfreq_reviewed_4_us_companies <- chocolate %>% \n  filter(company_location == \"U.S.A.\") %>% \n  count(company_manufacturer, sort = T) %>% \n  slice(1:4)\n\nfreq_reviewed_4_us_companies %>% \n  reactable::reactable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-0eacb2236b4c9f095f4a\" class=\"reactable html-widget\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-0eacb2236b4c9f095f4a\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"company_manufacturer\":[\"Fresco\",\"Arete\",\"Dandelion\",\"Guittard\"],\"n\":[39,32,25,22]},\"columns\":[{\"accessor\":\"company_manufacturer\",\"name\":\"company_manufacturer\",\"type\":\"character\"},{\"accessor\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"defaultPageSize\":10,\"paginationType\":\"numbers\",\"showPageInfo\":true,\"minRows\":1,\"dataKey\":\"f5defcdec83127f32b7c8b8519bf4f7e\",\"key\":\"f5defcdec83127f32b7c8b8519bf4f7e\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchocolate %>% \n  filter(company_location == \"U.S.A.\", \n         company_manufacturer %in% (freq_reviewed_4_us_companies %>% pull(company_manufacturer))) %>% \n  mutate(first_memorable_characteristics = first_memorable_characteristics %>% fct_lump(4)) %>% \n  count(company_manufacturer, first_memorable_characteristics, sort = T) %>% \n  ggplot(aes(first_memorable_characteristics, n))+\n  geom_col(fill = \"#769370\")+\n  facet_wrap(~company_manufacturer, scales = \"free_y\")+\n  theme(text = element_text(family = \"BenchNine\"),\n        plot.title = element_text(size = 12.5))+\n  labs(x = \"Memorable Characteristics\", y = \"\", \n       title = \"Words used to describe the highly reviewed chocolate companies in the United States\",\n       caption = \"Data Source: The Manhattan Chocolate Society\")\n```\n\n::: {.cell-output-display}\n![](tidy-tuesday-chocolate-ratings_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\nThe plot isn't super informative, but Guittard products were described as \"creamy\" and \"sweet\" more often than not. \n\n\n\n\n\n\n",
    "supporting": [
      "tidy-tuesday-chocolate-ratings_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/core-js-2.5.3/shim.min.js\"></script>\n<script src=\"../../site_libs/react-17.0.0/react.min.js\"></script>\n<script src=\"../../site_libs/react-17.0.0/react-dom.min.js\"></script>\n<script src=\"../../site_libs/reactwidget-1.0.0/react-tools.js\"></script>\n<script src=\"../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/reactable-binding-0.2.3/reactable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}